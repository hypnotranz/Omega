<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OmegaLLM Debugger</title>
  <link rel="stylesheet" href="style.css?v=2">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="app">
    <!-- Toolbar -->
    <header class="toolbar">
      <div class="toolbar-left">
        <span class="logo-icon">&#937;</span>
        <span class="logo-text">OmegaLLM</span>
        <span id="status-badge" class="status-badge status-idle">idle</span>
      </div>
      <div class="toolbar-center">
        <button class="btn btn-example" data-example="sentiment">Sentiment</button>
        <button class="btn btn-example" data-example="summarize">Summarize</button>
        <button class="btn btn-example" data-example="translate">Translate</button>
        <button class="btn btn-example" data-example="qa">Q&A</button>
        <button class="btn btn-example" data-example="chain">Chain</button>
      </div>
      <div class="toolbar-right">
        <span id="ws-status" class="ws-status ws-disconnected">disconnected</span>
      </div>
    </header>

    <!-- Main 3-Section Layout -->
    <main class="main-content">

      <!-- SECTION 1: Code (1/3) -->
      <section class="section section-code">
        <div class="section-header">
          <span class="section-title">Code</span>
          <div class="section-actions">
            <span style="font-size:10px;color:var(--text-muted);margin-right:8px">Ctrl+Enter to run</span>
            <button id="btn-clear" class="btn btn-ghost">Clear</button>
          </div>
        </div>
        <div class="section-body">
          <textarea id="code-editor" class="code-editor" spellcheck="false" placeholder="; Click an example above, or write code here
; Press Ctrl+Enter to load and run
;
; (define (ask question)
;   (effect infer.op (list question)))
;
; (ask &quot;What is 2+2?&quot;)"></textarea>
        </div>
      </section>

      <!-- SECTION 2: Execution (1/3) -->
      <section class="section section-execution">
        <div class="section-header">
          <span class="section-title">Execution</span>
          <div class="section-actions">
            <button id="btn-step" class="btn btn-control" title="Step (F10)">Step</button>
            <button id="btn-step-10" class="btn btn-control" title="Step 10">x10</button>
            <button id="btn-continue" class="btn btn-run" title="Continue (F5)">Continue</button>
            <button id="btn-run" class="btn btn-run-all" title="Run All (F8)">Run</button>
            <span class="step-display">Step <span id="step-count">0</span></span>
          </div>
        </div>
        <div class="section-body">
          <div id="execution-flow" class="execution-flow">
            <div class="execution-empty">Click an example or press Ctrl+Enter</div>
          </div>
        </div>
      </section>

      <!-- SECTION 3: State Tabs (1/3) -->
      <section class="section section-state">
        <div class="tabs-header">
          <button class="tab active" data-tab="control">Control</button>
          <button class="tab" data-tab="environment">Env</button>
          <button class="tab" data-tab="stack">Stack</button>
          <button class="tab" data-tab="handlers">Handlers</button>
          <button class="tab" data-tab="trace">Trace</button>
          <button class="tab" data-tab="breakpoints">Breaks</button>
        </div>
        <div class="tabs-body">
          <div id="tab-control" class="tab-pane active">
            <div id="control-display" class="state-content">No code loaded</div>
          </div>
          <div id="tab-environment" class="tab-pane">
            <div id="environment" class="state-content">No bindings</div>
          </div>
          <div id="tab-stack" class="tab-pane">
            <div id="call-stack" class="state-content">Empty</div>
          </div>
          <div id="tab-handlers" class="tab-pane">
            <div id="handlers" class="state-content">No handlers</div>
          </div>
          <div id="tab-trace" class="tab-pane">
            <div class="trace-controls">
              <button id="btn-back" class="btn btn-sm">Back</button>
              <input type="number" id="goto-step" class="goto-input" placeholder="Step #" min="0">
              <button id="btn-goto" class="btn btn-sm">Goto</button>
            </div>
            <div id="trace" class="state-content">No trace</div>
          </div>
          <div id="tab-breakpoints" class="tab-pane">
            <div class="break-controls">
              <select id="break-type" class="break-select">
                <option value="step">Step #</option>
                <option value="expr">Expression</option>
                <option value="effect">Effect</option>
              </select>
              <input type="text" id="break-condition" class="break-input" placeholder="Condition">
              <button id="btn-add-break" class="btn btn-sm">Add</button>
            </div>
            <div id="breakpoints" class="state-content">No breakpoints</div>
          </div>
        </div>
      </section>

    </main>

    <!-- Hidden compatibility elements -->
    <div class="hidden">
      <span id="session-id"></span>
      <button id="btn-new-session"></button>
      <button id="btn-pause"></button>
      <button id="btn-resume"></button>
      <input id="resume-value">
      <div id="effect-panel"></div>
      <div id="pending-effect"></div>
      <div id="result-panel"></div>
      <div id="result"></div>
      <div id="error-panel"></div>
      <div id="error"></div>
      <div id="history"></div>
    </div>
  </div>

  <script src="app.js?v=13"></script>
</body>
</html>
